webpackJsonp([7],{"/Xk+":function(t,e){},"Vg+r":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=r("aM3M"),o={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"order-address"},[t.hasAddress?t._e():r("a",{staticClass:"address",attrs:{href:"#/addressManage"}},[r("span",{staticClass:"address-btn"},[t._v("+添加收货地址")])]),t._v(" "),t.hasAddress?r("a",{staticClass:"address-box",attrs:{href:"#/addressManage"}},[r("ul",{staticClass:"address-contain"},[t._m(0),t._v(" "),r("li",{staticClass:"address-info"},[r("div",{staticClass:"name-and-phone"},[r("p",{staticClass:"address-name"},[t._v("收货人:"+t._s(t.model.consignee))]),t._v(" "),r("p",{staticClass:"address-phone"},[t._v(t._s(""==t.model.mobilePhone?t.model.landlinePhone:t.model.mobilePhone))])]),t._v(" "),r("p",{staticClass:"address-text"},[t._v("\n                "+t._s(t.model.province)+t._s(t.model.area)+t._s(t.model.city)+t._s(t.model.deliveryAddress)+"\n            ")])]),t._v(" "),t._m(1)])]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"address-icon"},[e("i",{staticClass:"icon icon-position"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"address-more"},[e("i",{staticClass:"icon iconfont icon-arrows-right"})])}]};var a=r("vSla")({data:function(){return{model:{},hasAddress:!1}},created:function(){var t=this;this.$store.getters.jwt&&this.api.order.defaultAddress().then(function(e){"200"==e.code&&(t.model=e.model,t.hasAddress=!0)}),this.$store.getters.orderAffirm}},o,!1,function(t){r("ev8U")},"data-v-74a7c58f",null).exports,i=(r("PBmY"),r("I4Nl")),n=r.n(i),d=r("lBMc"),c=r("yydA"),l={props:["func"],data:function(){return{dataList:[],orderRemark:"",payEnum:"2",payType:[{label:"货到付款",value:"1"},{label:"在线支付",value:"2"}],productGroup:[],productAmount:0,freight:0,discountPrice:0}},watch:{orderRemark:function(t){this.$store.dispatch("saveOrderRemark",t)},payEnum:function(t){this.$store.dispatch("savePayType",t)},dataList:function(t){this.productGroup=d.a.match(t)}},methods:{dataBuild:function(t){for(var e=this,r=[],s=0;s<t.length;s++){var o=t[s];o&&r.push({productId:o.productId,quantity:o.productCount,productCount:o.productCount,merchantBasicId:o.merchantBasicId,isGroup:!0,promotionId:o.promotionId,promotionFormId:o.promotionId})}this.api.orderServer.orderPriceCalculation(r).then(function(t){if("200"==t.code){var r=t.model;e.productAmount=r.productAmount,e.freight=r.transportCosts,e.discountPrice=r.discountPrice,e.func&&e.func(r.orderAmountPayable)}else n()(t.message)}),this.api.shopCart.shoppingCartPrice(r).then(function(r){if("200"==r.code)for(var s=function(s){var o=r.model.priceList[s];if(o){var a=t.filter(function(t){if(t.productId==o.productId&&t.merchantBasicId==o.merchantBasicId)return t});a.length>0&&e.dataList.push(c.assign(o,a[0]))}},o=0;o<r.model.priceList.length;o++)s(o);else n()(r.message)})}},created:function(){var t=this;if(this.$store.getters.jwt){var e=this.$store.getters.orderAffirm;if(0==e.length)return void this.$router.push({name:"home"});for(var r=[],s=0;s<e.length;s++){var o=e[s];r.push({productId:o.productId,merchantBasicId:o.merchantBasicId})}var a=[];this.api.goods.product(r).then(function(r){if("200"==r.code){for(var s=function(t){var s=r.model[t],o=e.filter(function(t){if(t.productId==s.productId&&t.merchantBasicId==s.merchantBasicId)return t});if(o.length>0){var i=c.assign(s,o[0]);a.push(i)}},o=0;o<r.model.length;o++)s(o);t.dataBuild(a)}else n()(r.message)}),this.orderRemark=this.$store.getters.orderRemark,this.$store.dispatch("savePayType",this.payEnum)}}},u={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"order-list"},[t._l(t.productGroup,function(e,s){return r("div",{key:s,staticClass:"order-item"},[r("div",{staticClass:"order-title"},[r("span",{staticClass:"order-title-text",domProps:{textContent:t._s(e[0].merchantName)}})]),t._v(" "),t._l(e,function(e,s){return r("div",{key:s,staticClass:"order-contain"},[r("dl",[r("dd",{staticClass:"order-body"},[r("div",{staticClass:"order-img"},[r("img",{attrs:{src:e.productImg,onerror:"imgError(this);"}})]),t._v(" "),r("div",{staticClass:"order-info"},[r("a",{staticClass:"order-info-name",domProps:{textContent:t._s(e.productName)}}),t._v(" "),r("p",{staticClass:"order-info-spec"},[t._v("\n            规格："+t._s(e.productSpecifications)+"\n          ")]),t._v(" "),r("p",{staticClass:"order-info-price"},[t._v("￥"+t._s(e.productPrice)+"\n            "),r("span",{staticClass:"info-number"},[t._v("\n              x"+t._s(e.productCount)+"\n            ")])])])])])])})],2)}),t._v(" "),r("div",{staticClass:"order-item"},[t._m(0),t._v(" "),r("div",{staticClass:"order-contain"},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.orderRemark,expression:"orderRemark"}],attrs:{type:"text",placeholder:"备注",maxlength:"60"},domProps:{value:t.orderRemark},on:{input:function(e){e.target.composing||(t.orderRemark=e.target.value)}}})])]),t._v(" "),r("div",{staticClass:"order-item"},[t._m(1),t._v(" "),r("div",{staticClass:"order-contain"},[r("div",{staticClass:"radio-pay"},[r("mt-radio",{attrs:{options:t.payType},model:{value:t.payEnum,callback:function(e){t.payEnum=e},expression:"payEnum"}})],1)])]),t._v(" "),r("div",{staticClass:"order-item"},[r("div",{staticClass:"order-title"},[r("span",{staticClass:"order-title-text"},[t._v("商品金额")]),t._v(" "),r("span",{staticClass:"order-totalPrice"},[t._v("\n        ￥"+t._s(t.productAmount)+"\n      ")])]),t._v(" "),r("div",{staticClass:"order-contain"},[r("dd",{staticClass:"contain-item"},[r("span",[t._v("促销优惠")]),t._v(" "),r("p",{staticClass:"ships"},[t._v("已优惠￥"+t._s(t.discountPrice))])])]),t._v(" "),r("div",{staticClass:"order-contain"},[r("dd",{staticClass:"contain-item"},[r("span",[t._v("运费")]),t._v(" "),r("p",{staticClass:"ships"},[t._v("￥"+t._s(t.freight))])])])])],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"order-title",attrs:{href:"#/invoice"}},[e("span",{staticClass:"order-title-text"},[this._v("发票信息")]),this._v(" "),e("span",{staticClass:"order-transport"},[e("i",{staticClass:"item-icon icon icon-right"})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"order-title"},[e("span",{staticClass:"order-title-text"},[this._v("支付方式")])])}]};var p=r("vSla")(l,u,!1,function(t){r("ol2i")},"data-v-d73b9964",null).exports,h={props:["totalPrice"],data:function(){return{price:0,model:{},addressShow:!1}},methods:{orderSubmit:function(){var t=this,e=this.$store.getters.orderAffirm;if(0!=e.length)if(this.model.regionId){for(var r=[],s=0;s<e.length;s++){var o=e[s];r.push({productId:o.productId,quantity:o.productCount,merchantBasicId:o.merchantBasicId,isGroup:!0,promotionId:o.promotionId,promotionFormId:o.promotionId})}var a=this.$store.getters.invoice,i={paymentType:this.$store.getters.payType,deliveryType:1,invoiceType:a.invoiceType,invoiceTitleType:a.invoiceTitleType,taxpayerId:a.taxpayerId,invoiceContentType:a.invoiceContentType,invoiceReceiveMail:a.invoiceReceiveMail,deliveryId:this.model.id,regionId:this.model.regionId,remark:this.$store.getters.orderRemark,ordersList:r};this.api.orderServer.ordersAdd(i).then(function(r){"200"==r.code?(t.$store.dispatch("deleteProduct",e),t.$store.dispatch("removeOrderAffirm"),1==i.paymentType?(t.$router.push({name:"orderEnd"}),t.$store.dispatch("saveOrderEnd",r.model)):(t.$router.push({name:"orderPay"}),t.$store.dispatch("saveOrderPay",r.model))):n()(r.message)})}else n()("请求填写收货地址！");else n()("您没有任何商品！")}},watch:{totalPrice:function(t){this.price=t}},created:function(){var t=this;this.totalPrice&&(this.price=this.totalPrice),this.$store.getters.jwt&&(this.addressShow=!0,this.api.order.defaultAddress().then(function(e){"200"==e.code&&(t.model=e.model)}))}},m={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"order-footer"},[r("div",{staticClass:"order-bar"},[r("div",{staticClass:"order-bar-text"},[t._v("\n        合计：\n        "),r("span",{staticClass:"total-price"},[t._v("\n        ￥"),r("a",{domProps:{textContent:t._s(t.price)}})])]),t._v(" "),r("a",{staticClass:"order-bar-btn",on:{click:function(e){t.orderSubmit()}}},[t._v("\n        提交订单\n      ")])])])},staticRenderFns:[]};var v=r("vSla")(h,m,!1,function(t){r("ul7/")},"data-v-aaa7231a",null).exports,f={name:"order",components:{helmet:s.a,orderAddress:a,orderList:p,orderFooter:v},data:function(){return{totalPrice:0}},methods:{totalPriceMatch:function(t){this.totalPrice=t}},created:function(){this.$store.getters.jwt||this.$router.push({name:"login"})}},_={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"order"},[e("helmet",{attrs:{title:"订单确认"}}),this._v(" "),e("order-address"),this._v(" "),e("order-list",{attrs:{func:this.totalPriceMatch}}),this._v(" "),e("order-footer",{attrs:{"total-price":this.totalPrice}})],1)},staticRenderFns:[]};var g=r("vSla")(f,_,!1,function(t){r("/Xk+")},"data-v-5146edbe",null);e.default=g.exports},ev8U:function(t,e){},lBMc:function(t,e,r){"use strict";function s(t,e){for(var r=!1,s=0;s<e.length;s++){if(e[s]==t){r=!0;break}}return r}var o=[];e.a={match:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=[],r=[],o=0;o<t.length;o++){var a=t[o];s(a.merchantBasicId,r)||r.push(a.merchantBasicId)}for(var i=0;i<r.length;i++){for(var n=r[i],d=[],c=0;c<t.length;c++){var l=t[c];l.merchantBasicId==n&&d.push(l)}e.push(d),d=[]}return e},findProduct:function(t,e,r){for(var s=!1,o=0;o<t.length;o++){var a=t[o];if(a.productId==e&&a.merchantBasicId==r){s=a;break}}return s},merchantChange:function(t){for(var e=0,r=0;r<t.length;r++){t[r].productSelect&&e++}return e==t.length},merchantSelect:function(t,e,r){for(var s=[],o=0;o<t.length;o++){var a=t[o];a.merchantBasicId==r&&(a.productSelect=e),s.push(a)}return s},promotionsMatch:function(t,e,r){for(var s={promotionId:"",slogan:"",promotionCount:0,productId:e,merchantBasicId:r},a=!1,i=0;i<o.length;i++){var n=o[i];if(n.productId==e&&n.merchantBasicId==r){s=n,a=!0;break}}if(!a&&t){var d=t[0];s={promotionId:d.promotionId,slogan:d.slogan,promotionCount:t.length,productId:e,merchantBasicId:r},o.push(s)}return s},findPromotionSelect:function(t,e){for(var r=0;r<o.length;r++){var s=o[r];if(s.productId==t&&s.merchantBasicId==e)return s.promotionId}return""},setPromotionSelect:function(t,e,r,s){for(var a=[],i=0;i<o.length;i++){var n=o[i];if(n.productId==r&&n.merchantBasicId==s)for(var d=0;d<t.length;d++){var c=t[d];if(c.promotionId==e){n.promotionId=e,n.slogan=c.slogan;break}}a.push(n)}o=a},buildPromotion:function(t){for(var e=[],r=0;r<t.length;r++){var s=t[r];s.promotionModel=this.promotionsMatch(s.promotions,s.productId,s.merchantBasicId),e.push(s)}return e},productCountMatch:function(t){for(var e=[],r=0;r<t.length;r++){var s=t[r];s.promotionModel=this.promotionsMatch(s.promotions,s.productId,s.merchantBasicId),e.push(s)}return e}}},ol2i:function(t,e){},"ul7/":function(t,e){}});
//# sourceMappingURL=7.c2e2e9d521608e144434.js.map